<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Geocomputation with R</title>
  <meta name="description" content="A book on geographic data with R.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Geocomputation with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://geocompr.robinlovelace.net/" />
  <meta property="og:image" content="https://geocompr.robinlovelace.net/images/cover.png" />
  <meta property="og:description" content="A book on geographic data with R." />
  <meta name="github-repo" content="Robinlovelace/geocompr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Geocomputation with R" />
  
  <meta name="twitter:description" content="A book on geographic data with R." />
  <meta name="twitter:image" content="https://geocompr.robinlovelace.net/images/cover.png" />

<meta name="author" content="Robin Lovelace, Jakub Nowosad, Jannes Muenchow">


<meta name="date" content="2018-09-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="location.html">
<link rel="next" href="conclusion.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.css" rel="stylesheet" />
<script src="libs/leaflet-minimap-3.3.1/Control.MiniMap.min.js"></script>
<script src="libs/leaflet-minimap-3.3.1/Minimap-binding.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99618359-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Geocomputation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-this-book-is-for"><i class="fa fa-check"></i>Who this book is for</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#real-world-impact"><i class="fa fa-check"></i>Real-world impact</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-geocomputation"><i class="fa fa-check"></i><b>1.1</b> What is geocomputation?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-geocomputation-with-r"><i class="fa fa-check"></i><b>1.2</b> Why geocomputation with R?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#software-for-geocomputation"><i class="fa fa-check"></i><b>1.3</b> Software for geocomputation</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rs-spatial-ecosystem"><i class="fa fa-check"></i><b>1.4</b> R’s spatial ecosystem</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#the-history-of-r-spatial"><i class="fa fa-check"></i><b>1.5</b> The history of R-spatial</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="2" data-path="spatial-class.html"><a href="spatial-class.html"><i class="fa fa-check"></i><b>2</b> Geographic data in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-class.html"><a href="spatial-class.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="spatial-class.html"><a href="spatial-class.html#vector-data"><i class="fa fa-check"></i><b>2.1</b> Vector data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-class.html"><a href="spatial-class.html#intro-sf"><i class="fa fa-check"></i><b>2.1.1</b> An introduction to simple features</a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-class.html"><a href="spatial-class.html#why-simple-features"><i class="fa fa-check"></i><b>2.1.2</b> Why simple features?</a></li>
<li class="chapter" data-level="2.1.3" data-path="spatial-class.html"><a href="spatial-class.html#basic-map"><i class="fa fa-check"></i><b>2.1.3</b> Basic map making</a></li>
<li class="chapter" data-level="2.1.4" data-path="spatial-class.html"><a href="spatial-class.html#base-args"><i class="fa fa-check"></i><b>2.1.4</b> Base plot arguments</a></li>
<li class="chapter" data-level="2.1.5" data-path="spatial-class.html"><a href="spatial-class.html#geometry"><i class="fa fa-check"></i><b>2.1.5</b> Geometry types</a></li>
<li class="chapter" data-level="2.1.6" data-path="spatial-class.html"><a href="spatial-class.html#sfg"><i class="fa fa-check"></i><b>2.1.6</b> Simple feature geometries (sfg)</a></li>
<li class="chapter" data-level="2.1.7" data-path="spatial-class.html"><a href="spatial-class.html#sfc"><i class="fa fa-check"></i><b>2.1.7</b> Simple feature columns (sfc)</a></li>
<li class="chapter" data-level="2.1.8" data-path="spatial-class.html"><a href="spatial-class.html#sf"><i class="fa fa-check"></i><b>2.1.8</b> The sf class</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-class.html"><a href="spatial-class.html#raster-data"><i class="fa fa-check"></i><b>2.2</b> Raster data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-class.html"><a href="spatial-class.html#an-introduction-to-raster"><i class="fa fa-check"></i><b>2.2.1</b> An introduction to raster</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-class.html"><a href="spatial-class.html#basic-map-raster"><i class="fa fa-check"></i><b>2.2.2</b> Basic map making</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-class.html"><a href="spatial-class.html#raster-classes"><i class="fa fa-check"></i><b>2.2.3</b> Raster classes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-class.html"><a href="spatial-class.html#crs-intro"><i class="fa fa-check"></i><b>2.3</b> Coordinate Reference Systems</a><ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-class.html"><a href="spatial-class.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.3.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-class.html"><a href="spatial-class.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>2.3.2</b> Projected coordinate systems</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-class.html"><a href="spatial-class.html#crs-in-r"><i class="fa fa-check"></i><b>2.3.3</b> CRSs in R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-class.html"><a href="spatial-class.html#units"><i class="fa fa-check"></i><b>2.4</b> Units</a></li>
<li class="chapter" data-level="2.5" data-path="spatial-class.html"><a href="spatial-class.html#ex2"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="attr.html"><a href="attr.html"><i class="fa fa-check"></i><b>3</b> Attribute data operations</a><ul>
<li class="chapter" data-level="" data-path="attr.html"><a href="attr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="attr.html"><a href="attr.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="attr.html"><a href="attr.html#vector-attribute-manipulation"><i class="fa fa-check"></i><b>3.2</b> Vector attribute manipulation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="attr.html"><a href="attr.html#vector-attribute-subsetting"><i class="fa fa-check"></i><b>3.2.1</b> Vector attribute subsetting</a></li>
<li class="chapter" data-level="3.2.2" data-path="attr.html"><a href="attr.html#vector-attribute-aggregation"><i class="fa fa-check"></i><b>3.2.2</b> Vector attribute aggregation</a></li>
<li class="chapter" data-level="3.2.3" data-path="attr.html"><a href="attr.html#vector-attribute-joining"><i class="fa fa-check"></i><b>3.2.3</b> Vector attribute joining</a></li>
<li class="chapter" data-level="3.2.4" data-path="attr.html"><a href="attr.html#vec-attr-creation"><i class="fa fa-check"></i><b>3.2.4</b> Creating attributes and removing spatial information</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="attr.html"><a href="attr.html#manipulating-raster-objects"><i class="fa fa-check"></i><b>3.3</b> Manipulating raster objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="attr.html"><a href="attr.html#raster-subsetting"><i class="fa fa-check"></i><b>3.3.1</b> Raster subsetting</a></li>
<li class="chapter" data-level="3.3.2" data-path="attr.html"><a href="attr.html#summarizing-raster-objects"><i class="fa fa-check"></i><b>3.3.2</b> Summarizing raster objects</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="attr.html"><a href="attr.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-operations.html"><a href="spatial-operations.html"><i class="fa fa-check"></i><b>4</b> Spatial data operations</a><ul>
<li class="chapter" data-level="" data-path="spatial-operations.html"><a href="spatial-operations.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="spatial-operations.html"><a href="spatial-operations.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-vec"><i class="fa fa-check"></i><b>4.2</b> Spatial operations on vector data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-subsetting"><i class="fa fa-check"></i><b>4.2.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatial-operations.html"><a href="spatial-operations.html#topological-relations"><i class="fa fa-check"></i><b>4.2.2</b> Topological relations</a></li>
<li class="chapter" data-level="4.2.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-joining"><i class="fa fa-check"></i><b>4.2.3</b> Spatial joining</a></li>
<li class="chapter" data-level="4.2.4" data-path="spatial-operations.html"><a href="spatial-operations.html#non-overlapping-joins"><i class="fa fa-check"></i><b>4.2.4</b> Non-overlapping joins</a></li>
<li class="chapter" data-level="4.2.5" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-aggr"><i class="fa fa-check"></i><b>4.2.5</b> Spatial data aggregation</a></li>
<li class="chapter" data-level="4.2.6" data-path="spatial-operations.html"><a href="spatial-operations.html#distance-relations"><i class="fa fa-check"></i><b>4.2.6</b> Distance relations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-ras"><i class="fa fa-check"></i><b>4.3</b> Spatial operations on raster data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spatial-operations.html"><a href="spatial-operations.html#spatial-raster-subsetting"><i class="fa fa-check"></i><b>4.3.1</b> Spatial subsetting</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatial-operations.html"><a href="spatial-operations.html#map-algebra"><i class="fa fa-check"></i><b>4.3.2</b> Map algebra</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatial-operations.html"><a href="spatial-operations.html#local-operations"><i class="fa fa-check"></i><b>4.3.3</b> Local operations</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatial-operations.html"><a href="spatial-operations.html#focal-operations"><i class="fa fa-check"></i><b>4.3.4</b> Focal operations</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatial-operations.html"><a href="spatial-operations.html#zonal-operations"><i class="fa fa-check"></i><b>4.3.5</b> Zonal operations</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatial-operations.html"><a href="spatial-operations.html#global-operations-and-distances"><i class="fa fa-check"></i><b>4.3.6</b> Global operations and distances</a></li>
<li class="chapter" data-level="4.3.7" data-path="spatial-operations.html"><a href="spatial-operations.html#merging-rasters"><i class="fa fa-check"></i><b>4.3.7</b> Merging rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatial-operations.html"><a href="spatial-operations.html#exercises-2"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geometric-operations.html"><a href="geometric-operations.html"><i class="fa fa-check"></i><b>5</b> Geometry operations</a><ul>
<li class="chapter" data-level="" data-path="geometric-operations.html"><a href="geometric-operations.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.1" data-path="geometric-operations.html"><a href="geometric-operations.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="geometric-operations.html"><a href="geometric-operations.html#geo-vec"><i class="fa fa-check"></i><b>5.2</b> Geometric operations on vector data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="geometric-operations.html"><a href="geometric-operations.html#simplification"><i class="fa fa-check"></i><b>5.2.1</b> Simplification</a></li>
<li class="chapter" data-level="5.2.2" data-path="geometric-operations.html"><a href="geometric-operations.html#centroids"><i class="fa fa-check"></i><b>5.2.2</b> Centroids</a></li>
<li class="chapter" data-level="5.2.3" data-path="geometric-operations.html"><a href="geometric-operations.html#buffers"><i class="fa fa-check"></i><b>5.2.3</b> Buffers</a></li>
<li class="chapter" data-level="5.2.4" data-path="geometric-operations.html"><a href="geometric-operations.html#affine-transformations"><i class="fa fa-check"></i><b>5.2.4</b> Affine transformations</a></li>
<li class="chapter" data-level="5.2.5" data-path="geometric-operations.html"><a href="geometric-operations.html#clipping"><i class="fa fa-check"></i><b>5.2.5</b> Clipping</a></li>
<li class="chapter" data-level="5.2.6" data-path="geometric-operations.html"><a href="geometric-operations.html#geometry-unions"><i class="fa fa-check"></i><b>5.2.6</b> Geometry unions</a></li>
<li class="chapter" data-level="5.2.7" data-path="geometric-operations.html"><a href="geometric-operations.html#type-trans"><i class="fa fa-check"></i><b>5.2.7</b> Type transformations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="geometric-operations.html"><a href="geometric-operations.html#geo-ras"><i class="fa fa-check"></i><b>5.3</b> Geometric operations on raster data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="geometric-operations.html"><a href="geometric-operations.html#geometric-intersections"><i class="fa fa-check"></i><b>5.3.1</b> Geometric intersections</a></li>
<li class="chapter" data-level="5.3.2" data-path="geometric-operations.html"><a href="geometric-operations.html#extent-and-origin"><i class="fa fa-check"></i><b>5.3.2</b> Extent and origin</a></li>
<li class="chapter" data-level="5.3.3" data-path="geometric-operations.html"><a href="geometric-operations.html#aggregation-and-disaggregation"><i class="fa fa-check"></i><b>5.3.3</b> Aggregation and disaggregation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-vector"><i class="fa fa-check"></i><b>5.4</b> Raster-vector interactions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-cropping"><i class="fa fa-check"></i><b>5.4.1</b> Raster cropping</a></li>
<li class="chapter" data-level="5.4.2" data-path="geometric-operations.html"><a href="geometric-operations.html#raster-extraction"><i class="fa fa-check"></i><b>5.4.2</b> Raster extraction</a></li>
<li class="chapter" data-level="5.4.3" data-path="geometric-operations.html"><a href="geometric-operations.html#rasterization"><i class="fa fa-check"></i><b>5.4.3</b> Rasterization</a></li>
<li class="chapter" data-level="5.4.4" data-path="geometric-operations.html"><a href="geometric-operations.html#spatial-vectorization"><i class="fa fa-check"></i><b>5.4.4</b> Spatial vectorization</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="geometric-operations.html"><a href="geometric-operations.html#exercises-3"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html"><i class="fa fa-check"></i><b>6</b> Reprojecting geographic data</a><ul>
<li class="chapter" data-level="" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#when-to-reproject"><i class="fa fa-check"></i><b>6.2</b> When to reproject?</a></li>
<li class="chapter" data-level="6.3" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#which-crs-to-use"><i class="fa fa-check"></i><b>6.3</b> Which CRS to use?</a></li>
<li class="chapter" data-level="6.4" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#reproj-vec-geom"><i class="fa fa-check"></i><b>6.4</b> Reprojecting vector geometries</a></li>
<li class="chapter" data-level="6.5" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#modifying-map-projections"><i class="fa fa-check"></i><b>6.5</b> Modifying map projections</a></li>
<li class="chapter" data-level="6.6" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#reprojecting-raster-geometries"><i class="fa fa-check"></i><b>6.6</b> Reprojecting raster geometries</a></li>
<li class="chapter" data-level="6.7" data-path="reproj-geo-data.html"><a href="reproj-geo-data.html#exercises-4"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="read-write.html"><a href="read-write.html"><i class="fa fa-check"></i><b>7</b> Geographic data I/O</a><ul>
<li class="chapter" data-level="" data-path="read-write.html"><a href="read-write.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="read-write.html"><a href="read-write.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="read-write.html"><a href="read-write.html#retrieving-data"><i class="fa fa-check"></i><b>7.2</b> Retrieving open data</a></li>
<li class="chapter" data-level="7.3" data-path="read-write.html"><a href="read-write.html#geographic-data-packages"><i class="fa fa-check"></i><b>7.3</b> Geographic data packages</a></li>
<li class="chapter" data-level="7.4" data-path="read-write.html"><a href="read-write.html#file-formats"><i class="fa fa-check"></i><b>7.4</b> File formats</a></li>
<li class="chapter" data-level="7.5" data-path="read-write.html"><a href="read-write.html#data-input"><i class="fa fa-check"></i><b>7.5</b> Data Input (I)</a><ul>
<li class="chapter" data-level="7.5.1" data-path="read-write.html"><a href="read-write.html#vector-data-1"><i class="fa fa-check"></i><b>7.5.1</b> Vector data</a></li>
<li class="chapter" data-level="7.5.2" data-path="read-write.html"><a href="read-write.html#raster-data-1"><i class="fa fa-check"></i><b>7.5.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="read-write.html"><a href="read-write.html#data-output"><i class="fa fa-check"></i><b>7.6</b> Data output (O)</a><ul>
<li class="chapter" data-level="7.6.1" data-path="read-write.html"><a href="read-write.html#vector-data-2"><i class="fa fa-check"></i><b>7.6.1</b> Vector data</a></li>
<li class="chapter" data-level="7.6.2" data-path="read-write.html"><a href="read-write.html#raster-data-2"><i class="fa fa-check"></i><b>7.6.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="read-write.html"><a href="read-write.html#visual-outputs"><i class="fa fa-check"></i><b>7.7</b> Visual outputs</a></li>
<li class="chapter" data-level="7.8" data-path="read-write.html"><a href="read-write.html#exercises-5"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Extensions</b></span></li>
<li class="chapter" data-level="8" data-path="adv-map.html"><a href="adv-map.html"><i class="fa fa-check"></i><b>8</b> Making maps with R</a><ul>
<li class="chapter" data-level="" data-path="adv-map.html"><a href="adv-map.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="adv-map.html"><a href="adv-map.html#introduction-5"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="adv-map.html"><a href="adv-map.html#static-maps"><i class="fa fa-check"></i><b>8.2</b> Static maps</a><ul>
<li class="chapter" data-level="8.2.1" data-path="adv-map.html"><a href="adv-map.html#tmap-basics"><i class="fa fa-check"></i><b>8.2.1</b> tmap basics</a></li>
<li class="chapter" data-level="8.2.2" data-path="adv-map.html"><a href="adv-map.html#map-obj"><i class="fa fa-check"></i><b>8.2.2</b> Map objects</a></li>
<li class="chapter" data-level="8.2.3" data-path="adv-map.html"><a href="adv-map.html#aesthetics"><i class="fa fa-check"></i><b>8.2.3</b> Aesthetics</a></li>
<li class="chapter" data-level="8.2.4" data-path="adv-map.html"><a href="adv-map.html#color-settings"><i class="fa fa-check"></i><b>8.2.4</b> Color settings</a></li>
<li class="chapter" data-level="8.2.5" data-path="adv-map.html"><a href="adv-map.html#layouts"><i class="fa fa-check"></i><b>8.2.5</b> Layouts</a></li>
<li class="chapter" data-level="8.2.6" data-path="adv-map.html"><a href="adv-map.html#faceted-maps"><i class="fa fa-check"></i><b>8.2.6</b> Faceted maps</a></li>
<li class="chapter" data-level="8.2.7" data-path="adv-map.html"><a href="adv-map.html#inset-maps"><i class="fa fa-check"></i><b>8.2.7</b> Inset maps</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="adv-map.html"><a href="adv-map.html#animated-maps"><i class="fa fa-check"></i><b>8.3</b> Animated maps</a></li>
<li class="chapter" data-level="8.4" data-path="adv-map.html"><a href="adv-map.html#interactive-maps"><i class="fa fa-check"></i><b>8.4</b> Interactive maps</a></li>
<li class="chapter" data-level="8.5" data-path="adv-map.html"><a href="adv-map.html#mapping-applications"><i class="fa fa-check"></i><b>8.5</b> Mapping applications</a></li>
<li class="chapter" data-level="8.6" data-path="adv-map.html"><a href="adv-map.html#other-mapping-packages"><i class="fa fa-check"></i><b>8.6</b> Other mapping packages</a></li>
<li class="chapter" data-level="8.7" data-path="adv-map.html"><a href="adv-map.html#exercises-6"><i class="fa fa-check"></i><b>8.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gis.html"><a href="gis.html"><i class="fa fa-check"></i><b>9</b> Bridges to GIS software</a><ul>
<li class="chapter" data-level="" data-path="gis.html"><a href="gis.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="9.1" data-path="gis.html"><a href="gis.html#introduction-6"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="gis.html"><a href="gis.html#rqgis"><i class="fa fa-check"></i><b>9.2</b> (R)QGIS</a></li>
<li class="chapter" data-level="9.3" data-path="gis.html"><a href="gis.html#rsaga"><i class="fa fa-check"></i><b>9.3</b> (R)SAGA</a></li>
<li class="chapter" data-level="9.4" data-path="gis.html"><a href="gis.html#rgrass"><i class="fa fa-check"></i><b>9.4</b> GRASS through <strong>rgrass7</strong></a></li>
<li class="chapter" data-level="9.5" data-path="gis.html"><a href="gis.html#when-to-use-what"><i class="fa fa-check"></i><b>9.5</b> When to use what?</a></li>
<li class="chapter" data-level="9.6" data-path="gis.html"><a href="gis.html#other-bridges"><i class="fa fa-check"></i><b>9.6</b> Other bridges</a><ul>
<li class="chapter" data-level="9.6.1" data-path="gis.html"><a href="gis.html#gdal"><i class="fa fa-check"></i><b>9.6.1</b> Bridges to GDAL</a></li>
<li class="chapter" data-level="9.6.2" data-path="gis.html"><a href="gis.html#postgis"><i class="fa fa-check"></i><b>9.6.2</b> Bridges to spatial databases</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="gis.html"><a href="gis.html#exercises-7"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>10</b> Scripts, algorithms and functions</a><ul>
<li class="chapter" data-level="" data-path="algorithms.html"><a href="algorithms.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="10.1" data-path="algorithms.html"><a href="algorithms.html#intro-algorithms"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="algorithms.html"><a href="algorithms.html#scripts"><i class="fa fa-check"></i><b>10.2</b> Scripts</a></li>
<li class="chapter" data-level="10.3" data-path="algorithms.html"><a href="algorithms.html#geographic-algorithms"><i class="fa fa-check"></i><b>10.3</b> Geographic algorithms</a></li>
<li class="chapter" data-level="10.4" data-path="algorithms.html"><a href="algorithms.html#functions"><i class="fa fa-check"></i><b>10.4</b> Functions</a></li>
<li class="chapter" data-level="10.5" data-path="algorithms.html"><a href="algorithms.html#ex-algorithms"><i class="fa fa-check"></i><b>10.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-cv.html"><a href="spatial-cv.html"><i class="fa fa-check"></i><b>11</b> Statistical learning</a><ul>
<li class="chapter" data-level="" data-path="spatial-cv.html"><a href="spatial-cv.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1" data-path="spatial-cv.html"><a href="spatial-cv.html#intro-cv1"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-cv.html"><a href="spatial-cv.html#case-landslide"><i class="fa fa-check"></i><b>11.2</b> Case study: Landslide susceptibility</a></li>
<li class="chapter" data-level="11.3" data-path="spatial-cv.html"><a href="spatial-cv.html#conventional-model"><i class="fa fa-check"></i><b>11.3</b> Conventional modeling approach in R</a></li>
<li class="chapter" data-level="11.4" data-path="spatial-cv.html"><a href="spatial-cv.html#intro-cv"><i class="fa fa-check"></i><b>11.4</b> Introduction to (spatial) cross-validation</a></li>
<li class="chapter" data-level="11.5" data-path="spatial-cv.html"><a href="spatial-cv.html#spatial-cv-with-mlr"><i class="fa fa-check"></i><b>11.5</b> Spatial CV with <strong>mlr</strong></a><ul>
<li class="chapter" data-level="11.5.1" data-path="spatial-cv.html"><a href="spatial-cv.html#glm"><i class="fa fa-check"></i><b>11.5.1</b> Generalized linear model</a></li>
<li class="chapter" data-level="11.5.2" data-path="spatial-cv.html"><a href="spatial-cv.html#svm"><i class="fa fa-check"></i><b>11.5.2</b> Spatial tuning of machine-learning hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="spatial-cv.html"><a href="spatial-cv.html#conclusions"><i class="fa fa-check"></i><b>11.6</b> Conclusions</a></li>
<li class="chapter" data-level="11.7" data-path="spatial-cv.html"><a href="spatial-cv.html#exercises-8"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Applications</b></span></li>
<li class="chapter" data-level="12" data-path="transport.html"><a href="transport.html"><i class="fa fa-check"></i><b>12</b> Transportation</a><ul>
<li class="chapter" data-level="" data-path="transport.html"><a href="transport.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="transport.html"><a href="transport.html#introduction-7"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="transport.html"><a href="transport.html#bris-case"><i class="fa fa-check"></i><b>12.2</b> A case study of Bristol</a></li>
<li class="chapter" data-level="12.3" data-path="transport.html"><a href="transport.html#transport-zones"><i class="fa fa-check"></i><b>12.3</b> Transport zones</a></li>
<li class="chapter" data-level="12.4" data-path="transport.html"><a href="transport.html#desire-lines"><i class="fa fa-check"></i><b>12.4</b> Desire lines</a></li>
<li class="chapter" data-level="12.5" data-path="transport.html"><a href="transport.html#routes"><i class="fa fa-check"></i><b>12.5</b> Routes</a></li>
<li class="chapter" data-level="12.6" data-path="transport.html"><a href="transport.html#nodes"><i class="fa fa-check"></i><b>12.6</b> Nodes</a></li>
<li class="chapter" data-level="12.7" data-path="transport.html"><a href="transport.html#route-networks"><i class="fa fa-check"></i><b>12.7</b> Route networks</a></li>
<li class="chapter" data-level="12.8" data-path="transport.html"><a href="transport.html#prioritizing-new-infrastructure"><i class="fa fa-check"></i><b>12.8</b> Prioritizing new infrastructure</a></li>
<li class="chapter" data-level="12.9" data-path="transport.html"><a href="transport.html#future-directions-of-travel"><i class="fa fa-check"></i><b>12.9</b> Future directions of travel</a></li>
<li class="chapter" data-level="12.10" data-path="transport.html"><a href="transport.html#ex-transport"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="location.html"><a href="location.html"><i class="fa fa-check"></i><b>13</b> Geomarketing</a><ul>
<li class="chapter" data-level="" data-path="location.html"><a href="location.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="location.html"><a href="location.html#introduction-8"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="location.html"><a href="location.html#case-study"><i class="fa fa-check"></i><b>13.2</b> Case study: bike shops in Germany</a></li>
<li class="chapter" data-level="13.3" data-path="location.html"><a href="location.html#tidy-the-input-data"><i class="fa fa-check"></i><b>13.3</b> Tidy the input data</a></li>
<li class="chapter" data-level="13.4" data-path="location.html"><a href="location.html#create-census-rasters"><i class="fa fa-check"></i><b>13.4</b> Create census rasters</a></li>
<li class="chapter" data-level="13.5" data-path="location.html"><a href="location.html#define-metropolitan-areas"><i class="fa fa-check"></i><b>13.5</b> Define metropolitan areas</a></li>
<li class="chapter" data-level="13.6" data-path="location.html"><a href="location.html#points-of-interest"><i class="fa fa-check"></i><b>13.6</b> Points of interest</a></li>
<li class="chapter" data-level="13.7" data-path="location.html"><a href="location.html#identifying-suitable-locations"><i class="fa fa-check"></i><b>13.7</b> Identifying suitable locations</a></li>
<li class="chapter" data-level="13.8" data-path="location.html"><a href="location.html#discussion-and-next-steps"><i class="fa fa-check"></i><b>13.8</b> Discussion and next steps</a></li>
<li class="chapter" data-level="13.9" data-path="location.html"><a href="location.html#exercises-9"><i class="fa fa-check"></i><b>13.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="eco.html"><a href="eco.html"><i class="fa fa-check"></i><b>14</b> Ecology</a><ul>
<li class="chapter" data-level="" data-path="eco.html"><a href="eco.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="eco.html"><a href="eco.html#introduction-9"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="eco.html"><a href="eco.html#data-and-data-preparation"><i class="fa fa-check"></i><b>14.2</b> Data and data preparation</a></li>
<li class="chapter" data-level="14.3" data-path="eco.html"><a href="eco.html#nmds"><i class="fa fa-check"></i><b>14.3</b> Reducing dimensionality</a></li>
<li class="chapter" data-level="14.4" data-path="eco.html"><a href="eco.html#modeling-the-floristic-gradient"><i class="fa fa-check"></i><b>14.4</b> Modeling the floristic gradient</a><ul>
<li class="chapter" data-level="14.4.1" data-path="eco.html"><a href="eco.html#mlr-building-blocks"><i class="fa fa-check"></i><b>14.4.1</b> <strong>mlr</strong> building blocks</a></li>
<li class="chapter" data-level="14.4.2" data-path="eco.html"><a href="eco.html#predictive-mapping"><i class="fa fa-check"></i><b>14.4.2</b> Predictive mapping</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="eco.html"><a href="eco.html#conclusions-1"><i class="fa fa-check"></i><b>14.5</b> Conclusions</a></li>
<li class="chapter" data-level="14.6" data-path="eco.html"><a href="eco.html#exercises-10"><i class="fa fa-check"></i><b>14.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>15</b> Conclusion</a><ul>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html#prerequisites-13"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="conclusion.html"><a href="conclusion.html#gaps"><i class="fa fa-check"></i><b>15.1</b> Gaps and overlaps</a></li>
<li class="chapter" data-level="15.2" data-path="conclusion.html"><a href="conclusion.html#next"><i class="fa fa-check"></i><b>15.2</b> Where next?</a></li>
<li class="chapter" data-level="15.3" data-path="conclusion.html"><a href="conclusion.html#benefit"><i class="fa fa-check"></i><b>15.3</b> Geo* for social benefit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://robinlovelace.net/">Robin Lovelace</a></li>
<li><a href="https://nowosad.github.io/">Jakub Nowosad</a></li>
<li><a href="http://www.geographie.uni-jena.de/en/Muenchow.html">Jannes Muenchow</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geocomputation with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eco" class="section level1">
<h1><span class="header-section-number">14</span> Ecology</h1>
<div id="prerequisites-12" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<p>This chapter assumes you have a strong grasp of spatial data analysis and processing, covered in chapters <a href="spatial-class.html#spatial-class">2</a> to <a href="geometric-operations.html#geometric-operations">5</a>.
In it you will also make use of R’s interfaces to dedicated GIS software, and spatial cross validation, topics covered in chapters <a href="gis.html#gis">9</a> and <a href="spatial-cv.html#spatial-cv">11</a> respectively.</p>
<p>The chapter uses the following packages:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb440-2" data-line-number="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb440-3" data-line-number="3"><span class="kw">library</span>(RQGIS)</a>
<a class="sourceLine" id="cb440-4" data-line-number="4"><span class="kw">library</span>(mlr)</a>
<a class="sourceLine" id="cb440-5" data-line-number="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb440-6" data-line-number="6"><span class="kw">library</span>(vegan)</a></code></pre></div>
</div>
<div id="introduction-9" class="section level2">
<h2><span class="header-section-number">14.1</span> Introduction</h2>
<p>Fog oases are one of the most fascinating vegetation formations we have ever encountered.
These formations, locally termed <em>lomas</em>, develop on mountains along the coastal deserts of Peru and Chile.
The deserts’ extreme conditions and remoteness provide the habitat for a unique ecosystem, including species endemic to the fog oases.
Despite the arid conditions and low levels of precipitation of around 30-50 mm per year on average, fog deposition increases the amount of water available to plants during austal winter.
This results in green southern-facing mountain slopes along the coastal strip of Peru (Fig. <a href="eco.html#fig:study-area-mongon">14.1</a>).
This fog, which develops below the temperature inversion caused by the cold Humboldt current in austral winter, provides the name for this habitat.
Every few years, the El Niño phenomenon brings torrential rainfall to this sun-baked environment <span class="citation">(Dillon, Nakazawa, and Leiva <a href="#ref-dillon_lomas_2003">2003</a>)</span>.
This causes the desert to bloom, and provides tree seedlings a chance to develop roots long enough to survive the following arid conditions.</p>
<p>Unfortunately fog oases are heavily endangered.
This is mostly due to human activity (agriculture and climate change).
To effectively protect the last remnants of this unique vegetation ecosystem, evidence is needed on the composition and spatial distribution of the native flora <span class="citation">(J. Muenchow, Bräuning, et al. <a href="#ref-muenchow_predictive_2013">2013</a>; J. Muenchow, Hauenstein, et al. <a href="#ref-muenchow_soil_2013">2013</a>)</span>.
<em>Lomas</em> mountains also have economic value as a tourist destination, and can contribute to the well-being of local people via recreation.
For example, most Peruvians live in the coastal desert, and <em>lomas</em> mountains are frequently the closest “green” destination.</p>
<p>In this chapter we will demonstrate ecological applications of some of the techniques learned in the previous chapters.
This case study will involve analyzing the composition and the spatial distribution of the vascular plants on the southern slope of Mt. Mongón, a <em>lomas</em> mountain near Casma on the central northern coast of Peru (Fig. <a href="eco.html#fig:study-area-mongon">14.1</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:study-area-mongon"></span>
<img src="https://user-images.githubusercontent.com/1825120/38989956-6eae7c9a-43d0-11e8-8f25-3dd3594f7e74.png" alt="The Mt. Mongón study area, from Muenchow, Schratz, and Brenning (2017)." width="60%" />
<p class="caption">
Figure 14.1: The Mt. Mongón study area, from Muenchow, Schratz, and Brenning (2017).
</p>
</div>
<p>During a field study to Mt. Mongón we recorded all vascular plants living in 100 randomly sampled 4x4 m<sup>2</sup> plots in the austral winter of 2011 <span class="citation">(J. Muenchow, Bräuning, et al. <a href="#ref-muenchow_predictive_2013">2013</a>)</span>.
The sampling coincided with a strong La Niña event that year (see ENSO monitoring of the <a href="http://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php">NOASS Climate Prediction Center</a>).
This led to even higher levels of aridity than usual in the coastal desert.
On the other hand, it also increased fog activity on the southern slopes of Peruvian <em>lomas</em> mountains.</p>
<!--
The first hypothesis is that four plant belts will be found along the altitudinal gradient: a low-elevation *Tillandsia* belt, a herbaceous belt, a bromeliad belt, and an uppermost succulent belt [@muenchow_soil_2013].
-->
<p>Ordinations are dimension-reducing techniques which allow the extraction of the main gradients from a (noisy) dataset, in our case the floristic gradient developing along the southern mountain slope.
In this chapter we will model the first ordination axis, i.e., the floristic gradient, as a function of environmental predictors such as altitude, slope, catchment area and NDVI.
For this, we will make use of a random forest model - a very popular machine learning algorithm <span class="citation">(Breiman <a href="#ref-breiman_random_2001">2001</a>)</span>.
The model will allow us to make spatial predictions of the floristic composition anywhere in the study area.
To guarantee an optimal prediction, it is advisable to tune beforehand the hyperparameters with the help of spatial cross-validation (see section <a href="spatial-cv.html#svm">11.5.2</a>).</p>
</div>
<div id="data-and-data-preparation" class="section level2">
<h2><span class="header-section-number">14.2</span> Data and data preparation</h2>
<p>All the data needed for the subsequent analyses is available via the <strong>RQGIS</strong> package.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;study_area&quot;</span>, <span class="st">&quot;random_points&quot;</span>, <span class="st">&quot;comm&quot;</span>, <span class="st">&quot;dem&quot;</span>, <span class="st">&quot;ndvi&quot;</span>)</a></code></pre></div>
<p><code>study_area</code> is an sf polygon representing the outlines of the study area.
<code>random_points</code> is an sf-object, and contains the 100 randomly chosen sites.
<code>comm</code> is a community matrix of the wide data format <span class="citation">(Wickham <a href="#ref-wickham_tidy_2014">2014</a><a href="#ref-wickham_tidy_2014">b</a>)</span> where the rows represent the visited sites and the columns the observed species.<a href="#fn79" class="footnote-ref" id="fnref79"><sup>79</sup></a>
The values represent species cover per site, and were recorded as the area covered by a species in proportion to the site area in percentage points.
The rownames of <code>comm</code> correspond to the <code>id</code> column of <code>random_points</code>.
Though <code>comm</code> only consists of 84 rows, we have in fact visited 100 sites in the field, however, in 16 of them no species were found.
<code>dem</code> is the digital elevation model for the study area, and <code>ndvi</code> is the Normalized Difference Vegetation Index (NDVI) computed from the red and near-infrared channels of a Landsat scene (see section <a href="spatial-operations.html#local-operations">4.3.3</a> and <code>?ndvi</code>).
Visualizing the data helps to get more familiar with it:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="figures/unnamed-chunk-5-1.png" alt="Study mask (polygon), location of the sampling sites (black points) and DEM in the background." width="576" />
<p class="caption">
Figure 14.2: Study mask (polygon), location of the sampling sites (black points) and DEM in the background.
</p>
</div>
<p>The next step is to compute variables which we will predominantly need for the modeling and predictive mapping (see section <a href="eco.html#predictive-mapping">14.4.2</a>) but also for aligning the NMDS axes with the main gradient, altitude and humidity, respectively, in the study area (see section <a href="eco.html#nmds">14.3</a>).</p>
<p>Specifically, we will compute catchment slope and catchment area from a digital elevation model using R-GIS bridges (see Chapter <a href="gis.html#gis">9</a>).
Curvatures might also represent valuable predictors, in the exercise section you can find out how they would change the modeling result.</p>
<p>To compute catchment area and catchment slope, we will make use of the <code>saga:sagawetnessindex</code> function.<a href="#fn80" class="footnote-ref" id="fnref80"><sup>80</sup></a>
<code>get_usage()</code> returns all function parameters and default values of a specific geoalgorithm.
Here, we present only a selection of the complete output.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1"><span class="kw">get_usage</span>(<span class="st">&quot;saga:sagawetnessindex&quot;</span>)</a>
<a class="sourceLine" id="cb442-2" data-line-number="2"><span class="co">#&gt;ALGORITHM: Saga wetness index</span></a>
<a class="sourceLine" id="cb442-3" data-line-number="3"><span class="co">#&gt;  DEM &lt;ParameterRaster&gt;</span></a>
<a class="sourceLine" id="cb442-4" data-line-number="4"><span class="co">#&gt;  ...</span></a>
<a class="sourceLine" id="cb442-5" data-line-number="5"><span class="co">#&gt;  SLOPE_TYPE &lt;ParameterSelection&gt;</span></a>
<a class="sourceLine" id="cb442-6" data-line-number="6"><span class="co">#&gt;  ...</span></a>
<a class="sourceLine" id="cb442-7" data-line-number="7"><span class="co">#&gt;  AREA &lt;OutputRaster&gt;</span></a>
<a class="sourceLine" id="cb442-8" data-line-number="8"><span class="co">#&gt;  SLOPE &lt;OutputRaster&gt;</span></a>
<a class="sourceLine" id="cb442-9" data-line-number="9"><span class="co">#&gt;  AREA_MOD &lt;OutputRaster&gt;</span></a>
<a class="sourceLine" id="cb442-10" data-line-number="10"><span class="co">#&gt;  TWI &lt;OutputRaster&gt;</span></a>
<a class="sourceLine" id="cb442-11" data-line-number="11"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb442-12" data-line-number="12"><span class="co">#&gt;SLOPE_TYPE(Type of Slope)</span></a>
<a class="sourceLine" id="cb442-13" data-line-number="13"><span class="co">#&gt;  0 - [0] local slope</span></a>
<a class="sourceLine" id="cb442-14" data-line-number="14"><span class="co">#&gt;  1 - [1] catchment slope</span></a>
<a class="sourceLine" id="cb442-15" data-line-number="15"><span class="co">#&gt; ...</span></a></code></pre></div>
<p>Subsequently, we can specify the needed parameters using R named arguments (see section <a href="gis.html#rqgis">9.2</a>).
Remember that we can use a <code>RasterLayer</code> living in R’s global environment to specify the input raster <code>DEM</code> (see section <a href="gis.html#rqgis">9.2</a>).
Specifying 1 as the <code>SLOPE_TYPE</code> makes sure that the algorithm will return the catchment slope.
The resulting output rasters should be saved to temporary files with an <code>.sdat</code> extension which is a SAGA raster format.
Setting <code>load_output</code> to <code>TRUE</code> ensures that the resulting rasters will be imported into R.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" data-line-number="1"><span class="co"># environmental predictors: catchment slope and catchment area</span></a>
<a class="sourceLine" id="cb443-2" data-line-number="2">ep =<span class="st"> </span><span class="kw">run_qgis</span>(<span class="dt">alg =</span> <span class="st">&quot;saga:sagawetnessindex&quot;</span>,</a>
<a class="sourceLine" id="cb443-3" data-line-number="3">              <span class="dt">DEM =</span> dem,</a>
<a class="sourceLine" id="cb443-4" data-line-number="4">              <span class="dt">SLOPE_TYPE =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb443-5" data-line-number="5">              <span class="dt">SLOPE =</span> <span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.sdat&quot;</span>),</a>
<a class="sourceLine" id="cb443-6" data-line-number="6">              <span class="dt">AREA =</span> <span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.sdat&quot;</span>),</a>
<a class="sourceLine" id="cb443-7" data-line-number="7">              <span class="dt">load_output =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb443-8" data-line-number="8">              <span class="dt">show_output_paths =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>This gives back the list <code>ep</code> consisting of two elements named <code>AREA</code> and <code>SLOPE</code>.
Let us add two more raster objects to the list, namely <code>dem</code> and <code>ndvi</code>, and convert it into a raster stack (see section <a href="spatial-class.html#raster-classes">2.2.3</a>), .</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1">ep =<span class="st"> </span><span class="kw">c</span>(dem, ndvi, ep) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb444-2" data-line-number="2"><span class="st">  </span><span class="kw">stack</span>()</a>
<a class="sourceLine" id="cb444-3" data-line-number="3"><span class="kw">names</span>(ep) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dem&quot;</span>, <span class="st">&quot;ndvi&quot;</span>, <span class="st">&quot;carea&quot;</span>, <span class="st">&quot;cslope&quot;</span>)</a></code></pre></div>
<p>Additionally, the catchment area values are highly skewed to the right (<code>hist(ep$carea)</code>).
A log10-transformation makes the distribution more normal.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1">ep<span class="op">$</span>carea =<span class="st"> </span><span class="kw">log10</span>(ep<span class="op">$</span>carea)</a></code></pre></div>
<p>Finally, we can extract the terrain attributes to our field observations (see also section <a href="geometric-operations.html#raster-extraction">5.4.2</a>).</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" data-line-number="1">random_points[, <span class="kw">names</span>(ep)] =<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(ep, <span class="kw">as</span>(random_points, <span class="st">&quot;Spatial&quot;</span>))</a></code></pre></div>
</div>
<div id="nmds" class="section level2">
<h2><span class="header-section-number">14.3</span> Reducing dimensionality</h2>
<p>Ordinations are a popular tool in vegetation science to extract the main information, frequently corresponding to ecological gradients, from large species-plot matrices mostly filled with 0s.
However, they are also used in remote sensing, the soil sciences, geomarketing and many other fields.
If you are unfamiliar with ordination techniques or in need of a refresher, have a look at Michael W. Palmers <a href="http://ordination.okstate.edu/overview.htm">webpage</a> for a short introduction to popular ordination techniques in ecology and at <span class="citation">Borcard, Gillet, and Legendre (<a href="#ref-borcard_numerical_2011">2011</a>)</span> for a deeper look on how to apply these techniques in R.
<strong>vegan</strong>’s package documentation is also a very helpful resource (<code>vignette(package = &quot;vegan&quot;)</code>).</p>
<p>Principal component analysis (PCA) is probably the most famous ordination technique.
It is a great tool to reduce dimensionality if one can expect linear relationships between variables, and if the joint absence of a variable (for example calcium) in two plots (observations) can be considered a similarity.
This is barely the case with vegetation data.</p>
<p>For one, relationships are usually non-linear along environmental gradients.
That means the presence of a plant usually follows a unimodal relationship along a gradient (e.g., humidity, temperature or salinity) with a peak at the most favorable conditions and declining ends towards the unfavorable conditions.</p>
<p>Secondly, the joint absence of a species in two plots is hardly an indication for similarity.
Suppose a plant species is absent from the driest (e.g., an extreme desert) and the most moist locations (e.g., a tree savanna) of our sampling.
Then we really should refrain from counting this as a similarity because it is very likely that the only thing these two completely different environmental settings have in common in terms of floristic composition is the shared absence of species (except for rare ubiquitous species).</p>
<p>Non-metric multidimensional scaling (NMDS) is one popular dimension-reducing technique in ecology <span class="citation">(von Wehrden et al. <a href="#ref-vonwehrden_pluralism_2009">2009</a>)</span>.
NMDS reduces the rank-based differences between the distances between objects in the original matrix and distances between the ordinated objects.
The difference is expressed as stress.
The lower the stress value, the better the ordination, i.e. the low-dimensional representation of the original matrix.
Stress values lower than 10 represent an excellent fit, stress values of around 15 are still good, and values greater than 20 represent a poor fit <span class="citation">(McCune, Grace, and Urban <a href="#ref-mccune_analysis_2002">2002</a>)</span>.
In R, <code>metaMDS()</code> of the <strong>vegan</strong> package can execute a NMDS.
As input it expects a community matrix with the sites as rows and the species as columns, e.g.:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="co"># sites 35 to 40 and corresponding occurrences of the first five species in the</span></a>
<a class="sourceLine" id="cb447-2" data-line-number="2"><span class="co"># table</span></a>
<a class="sourceLine" id="cb447-3" data-line-number="3">comm[<span class="dv">35</span><span class="op">:</span><span class="dv">40</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb447-4" data-line-number="4"><span class="co">#&gt;    Alon_meri Alst_line Alte_hali Alte_porr Anth_eccr</span></a>
<a class="sourceLine" id="cb447-5" data-line-number="5"><span class="co">#&gt; 35         0         0         0       0.0     1.000</span></a>
<a class="sourceLine" id="cb447-6" data-line-number="6"><span class="co">#&gt; 36         0         0         1       0.0     0.500</span></a>
<a class="sourceLine" id="cb447-7" data-line-number="7"><span class="co">#&gt; 37         0         0         0       0.0     0.125</span></a>
<a class="sourceLine" id="cb447-8" data-line-number="8"><span class="co">#&gt; 38         0         0         0       0.0     3.000</span></a>
<a class="sourceLine" id="cb447-9" data-line-number="9"><span class="co">#&gt; 39         0         0         0       0.0     2.000</span></a>
<a class="sourceLine" id="cb447-10" data-line-number="10"><span class="co">#&gt; 40         0         0         0       0.2     0.125</span></a></code></pre></div>
<p>Often ordinations using presence-absence data yield better results though the prize is, of course, a less informative input matrix (see also exercises).
<code>decostand()</code> converts numerical observations into presences and absences with 1 indicating the occurrence of a species and 0 the absence of a species.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" data-line-number="1">pa =<span class="st"> </span><span class="kw">decostand</span>(comm, <span class="st">&quot;pa&quot;</span>)</a></code></pre></div>
<p>The resulting output matrix serves as input for the NMDS.
<code>k</code> specifies the number of output axes, here, set to 4.<a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a>
NMDS is an iterative procedure trying to make the ordinated space more similar to the input matrix in each step.
To make sure that the algorithm converges, we set the number of steps to 500 (<code>try</code> parameter).</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">25072018</span>)</a>
<a class="sourceLine" id="cb449-2" data-line-number="2">nmds =<span class="st"> </span><span class="kw">metaMDS</span>(<span class="dt">comm =</span> pa, <span class="dt">k =</span> <span class="dv">4</span>, <span class="dt">try =</span> <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb449-3" data-line-number="3">nmds<span class="op">$</span>stress</a>
<a class="sourceLine" id="cb449-4" data-line-number="4"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb449-5" data-line-number="5"><span class="co">#&gt; Run 498 stress 0.08834745 </span></a>
<a class="sourceLine" id="cb449-6" data-line-number="6"><span class="co">#&gt; ... Procrustes: rmse 0.004100446  max resid 0.03041186 </span></a>
<a class="sourceLine" id="cb449-7" data-line-number="7"><span class="co">#&gt; Run 499 stress 0.08874805 </span></a>
<a class="sourceLine" id="cb449-8" data-line-number="8"><span class="co">#&gt; ... Procrustes: rmse 0.01822361  max resid 0.08054538 </span></a>
<a class="sourceLine" id="cb449-9" data-line-number="9"><span class="co">#&gt; Run 500 stress 0.08863627 </span></a>
<a class="sourceLine" id="cb449-10" data-line-number="10"><span class="co">#&gt; ... Procrustes: rmse 0.01421176  max resid 0.04985418 </span></a>
<a class="sourceLine" id="cb449-11" data-line-number="11"><span class="co">#&gt; *** Solution reached</span></a>
<a class="sourceLine" id="cb449-12" data-line-number="12"><span class="co">#&gt; 0.08831395</span></a></code></pre></div>
<p>A stress value of 9 represents a very good result, which means that the reduced ordination space represents the large majority of the variance of the input matrix.
Overall, NMDS puts objects that are more similar (in terms of species composition) closer together in ordination space.
However, as opposed to most other ordination techniques, the axes are arbitrary and not necessarily ordered by importance <span class="citation">(Borcard, Gillet, and Legendre <a href="#ref-borcard_numerical_2011">2011</a>)</span>.
However, we already know that humidity represents the main gradient in the study area <span class="citation">(J. Muenchow, Bräuning, et al. <a href="#ref-muenchow_predictive_2013">2013</a>; Muenchow, Schratz, and Brenning <a href="#ref-muenchow_rqgis:_2017">2017</a>)</span>.
Since humidity is highly correlated with elevation, we rotate the NMDS in accordance with elevation.
Plotting the result reveals that the first axis is, as intended, clearly associated with altitude (Figure <a href="eco.html#fig:xy-nmds">14.3</a>).</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" data-line-number="1">elev =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(random_points, id <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(pa)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb450-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">pull</span>(dem)</a>
<a class="sourceLine" id="cb450-3" data-line-number="3"><span class="co"># rotating NMDS in accordance with altitude (proxy for humidity)</span></a>
<a class="sourceLine" id="cb450-4" data-line-number="4">rotnmds =<span class="st"> </span><span class="kw">MDSrotate</span>(nmds, elev)</a>
<a class="sourceLine" id="cb450-5" data-line-number="5"><span class="co"># extracting the first two axes</span></a>
<a class="sourceLine" id="cb450-6" data-line-number="6">sc =<span class="st"> </span><span class="kw">scores</span>(rotnmds, <span class="dt">choices =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb450-7" data-line-number="7"><span class="co"># plotting the first axis against altitude</span></a>
<a class="sourceLine" id="cb450-8" data-line-number="8"><span class="kw">plot</span>(<span class="dt">y =</span> sc[, <span class="dv">1</span>], <span class="dt">x =</span> elev, <span class="dt">xlab =</span> <span class="st">&quot;elevation in m&quot;</span>, </a>
<a class="sourceLine" id="cb450-9" data-line-number="9">     <span class="dt">ylab =</span> <span class="st">&quot;First NMDS axis&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">0.8</span>, <span class="dt">cex.axis =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:xy-nmds"></span>
<img src="figures/xy-nmds-1.png" alt="Plotting the first NMDS axis against altitude." width="60%" />
<p class="caption">
Figure 14.3: Plotting the first NMDS axis against altitude.
</p>
</div>
<p>The scores of the first NMDS axis represent the different vegetation formations, i.e. the floristic gradient, appearing along the slope of Mt. Mongón.
To spatially visualize them, we can model the NMDS scores with the previously created predictors (section <a href="eco.html#data-and-data-preparation">14.2</a>), and use the resulting model for predictive mapping (see next section).</p>
</div>
<div id="modeling-the-floristic-gradient" class="section level2">
<h2><span class="header-section-number">14.4</span> Modeling the floristic gradient</h2>
<p>To predict the floristic gradient spatially, we will make use of a random forest model.
Random forest models are frequently used in environmental and ecological modeling, and often provide the best results in terms of predictive performance <span class="citation">(Schratz et al. <a href="#ref-schratz_performance_nodate">2018</a>)</span>.
Here, we shortly introduce decision trees and bagging, since they form the basis of random forests.
We refer the reader to <span class="citation">James et al. (<a href="#ref-james_introduction_2013">2013</a>)</span> for a more detailed description of random forests and related techniques.</p>
<p>To introduce decision trees by example, we first construct a response-predictor matrix by joining the rotated NMDS scores to the field observations (<code>random_points</code>).
We will also use the resulting dataframe for the <strong>mlr</strong> modeling later on.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1"><span class="co"># construct response-predictor matrix</span></a>
<a class="sourceLine" id="cb451-2" data-line-number="2"><span class="co"># id- and response variable</span></a>
<a class="sourceLine" id="cb451-3" data-line-number="3">rp =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">as.numeric</span>(<span class="kw">rownames</span>(sc)),</a>
<a class="sourceLine" id="cb451-4" data-line-number="4">                <span class="dt">sc =</span> sc[, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb451-5" data-line-number="5"><span class="co"># join the predictors (dem, ndvi and terrain attributes)</span></a>
<a class="sourceLine" id="cb451-6" data-line-number="6">rp =<span class="st"> </span><span class="kw">inner_join</span>(random_points, rp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</a></code></pre></div>
<p>Decision trees split the predictor space into a number of regions.
To illustrate this, we apply a decision tree to our data using the scores of the first NMDS axis as the response (<code>sc</code>) and altitude (<code>dem</code>) as the only predictor.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tree&quot;</span>)</a>
<a class="sourceLine" id="cb452-2" data-line-number="2">tree_mo =<span class="st"> </span><span class="kw">tree</span>(sc <span class="op">~</span><span class="st"> </span>dem, <span class="dt">data =</span> rp)</a>
<a class="sourceLine" id="cb452-3" data-line-number="3"><span class="kw">plot</span>(tree_mo)</a>
<a class="sourceLine" id="cb452-4" data-line-number="4"><span class="kw">text</span>(tree_mo, <span class="dt">pretty =</span> <span class="dv">0</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tree"></span>
<img src="figures/tree-1.png" alt="Simple example of a decision tree with three internal nodes and four terminal nodes." width="576" />
<p class="caption">
Figure 14.4: Simple example of a decision tree with three internal nodes and four terminal nodes.
</p>
</div>
<!-- JM: rounding is wrong in the online figure output, ok, save the figure as png and include it separately -->
<p>The resulting tree consists of three internal nodes and four terminal nodes (Figure <a href="eco.html#fig:tree">14.4</a>).
The first internal node at the top of the tree assigns all observations which are below 328.5 m to the left and all other observations to the right branch.
The observations falling into the left branch have a mean NMDS score of -1.198.
Overall, we can interpret the tree as follows: the higher the elevation, the higher the NMDS score becomes.
Decision trees have a tendency to overfit, that is they mirror too closely the input data including its noise which in turn leads to bad predictive performances <span class="citation">(section <a href="spatial-cv.html#intro-cv">11.4</a>; James et al. <a href="#ref-james_introduction_2013">2013</a>)</span>.
Bootstrap aggregation (bagging) is an ensemble technique and helps to overcome this problem.
Ensemble techniques simply combine the predictions of multiple models.
Thus, bagging takes repeated samples from the same input data and averages the predictions.
This reduces the variance and overfitting with the result of a much better predictive accuracy compared to decision trees.
Finally, random forests extend and improve bagging by decorrelating trees which is desirable since averaging the predictions of highly correlated trees shows a higher variance and thus lower reliability than averaging predictions of decorrelated trees <span class="citation">(James et al. <a href="#ref-james_introduction_2013">2013</a>)</span>.
To achieve this, random forests use bagging but in contrast to the traditional bagging where each tree is allowed to use all available predictors, random forests only use a random sample of all available predictors.</p>
<!--
Recall that bagging is simply a special case of a random forest with m = p. Therefore, the randomForest() function can be used to perform both random forests and bagging. 
The argument mtry=13 indicates that all 13 predictors should be considered
for each split of the tree—in other words, that bagging should be done.
@james_introduction_2013
-->
<div id="mlr-building-blocks" class="section level3">
<h3><span class="header-section-number">14.4.1</span> <strong>mlr</strong> building blocks</h3>
<p>The code in this section largely follows the steps we have introduced in section <a href="spatial-cv.html#svm">11.5.2</a>.
The only differences are:</p>
<ol style="list-style-type: decimal">
<li>The response variable is numeric, hence a regression task will replace the classification task of section <a href="spatial-cv.html#svm">11.5.2</a>.</li>
<li>Instead of the AUROC which can only be used for categorical response variables, we will use the root mean squared error (RMSE) as performance measure.</li>
<li>We use a random forest model instead of a support vector machine which naturally goes along with different hyperparameters.</li>
<li>We are leaving the assessment of a bias-reduced performance measure as an exercise to the reader (see exercises).
Instead we show how to tune hyperparameters for (spatial) predictions.</li>
</ol>
<p>Remember that 125,500 models were necessary to retrieve bias-reduced performance estimates when using 100-repeated 5-fold spatial cross-validation and a random search of 50 iterations (see section <a href="spatial-cv.html#svm">11.5.2</a>).
In the hyperparameter tuning level, we found the best hyperparameter combination which in turn was used in the outer performance level for predicting the test data of a specific spatial partition (see also Figure <a href="spatial-cv.html#fig:inner-outer">11.6</a>).
This was done for five spatial partitions, and repeated a 100 times yielding in total 500 optimal hyperparameter combinations.
Which one should we use for making spatial predictions?
The answer is simple, none at all.
Remember, the tuning was done to retrieve a bias-reduced performance estimate, not to do the best possible spatial prediction.
For the latter, one estimates the best hyperparameter combination from the complete dataset.
This means, the inner hyperparameter tuning level is no longer needed which makes perfect sense since we are applying our model to new data (unvisited field observations) for which the true outcomes are unavailable, hence testing is impossible in any case.
Therefore, we tune the hyperparameters for a good spatial prediction on the complete dataset via a 5-fold spatial CV with one repetition.
<!-- If we used more than one repetition (say 2) we would retrieve multiple optimal tuned hyperparameter combinations (say 2) --></p>
<p>The preparation for the modeling using the <strong>mlr</strong> package includes the construction of a response-predictor matrix containing only variables which should be used in the modeling and the construction of a separate coordinate dataframe.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="co"># extract the coordinates into a separate dataframe</span></a>
<a class="sourceLine" id="cb453-2" data-line-number="2">coords =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_coordinates</span>(rp) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb453-3" data-line-number="3"><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb453-4" data-line-number="4"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y)</a>
<a class="sourceLine" id="cb453-5" data-line-number="5"><span class="co"># only keep response and predictors which should be used for the modeling</span></a>
<a class="sourceLine" id="cb453-6" data-line-number="6">rp =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(rp, <span class="op">-</span>id, <span class="op">-</span>spri) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb453-7" data-line-number="7"><span class="st">  </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>)</a></code></pre></div>
<p>Having constructed the input variables, we are all set for specifying the <strong>mlr</strong> building blocks (task, learner, and resampling).
We will use a regression task since the response variable is numeric.
The learner is a random forest model implementation from the <strong>ranger</strong> package.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" data-line-number="1"><span class="co"># create task</span></a>
<a class="sourceLine" id="cb454-2" data-line-number="2">task =<span class="st"> </span><span class="kw">makeRegrTask</span>(<span class="dt">data =</span> rp, <span class="dt">target =</span> <span class="st">&quot;sc&quot;</span>, <span class="dt">coordinates =</span> coords)</a>
<a class="sourceLine" id="cb454-3" data-line-number="3"><span class="co"># learner</span></a>
<a class="sourceLine" id="cb454-4" data-line-number="4">lrn_rf =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="dt">cl =</span> <span class="st">&quot;regr.ranger&quot;</span>, <span class="dt">predict.type =</span> <span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<p>As opposed to for example support vector machines (see section <a href="spatial-cv.html#svm">11.5.2</a>), random forests often already show good performances when used with the default values of their hyperparameters (which may be one reason for their popularity).
Still, tuning often moderately improves model results, and thus is worth the effort <span class="citation">(Probst, Wright, and Boulesteix <a href="#ref-probst_hyperparameters_2018">2018</a>)</span>.
Since we deal with geographic data, we will again make use of spatial cross-validation to tune the hyperparameters (see sections <a href="spatial-cv.html#intro-cv">11.4</a> and <a href="spatial-cv.html#spatial-cv-with-mlr">11.5</a>).
Specifically, we will use a five-fold spatial partitioning with only one repetition (<code>makeResampleDesc()</code>).
In each of these spatial partitions, we run 50 models (<code>makeTuneControlRandom</code>) to find the optimal hyperparameter combination.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="co"># spatial partitioning</span></a>
<a class="sourceLine" id="cb455-2" data-line-number="2">perf_level =<span class="st"> </span><span class="kw">makeResampleDesc</span>(<span class="st">&quot;SpCV&quot;</span>, <span class="dt">iters =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb455-3" data-line-number="3"><span class="co"># specifying random search</span></a>
<a class="sourceLine" id="cb455-4" data-line-number="4">ctrl =<span class="st"> </span><span class="kw">makeTuneControlRandom</span>(<span class="dt">maxit =</span> 50L)</a></code></pre></div>
<p>In random forests, the hyperparameters <code>mtry</code>, <code>min.node.size</code> and <code>sample.fraction</code> determine the degree of randomness, and should be tuned <span class="citation">(Probst, Wright, and Boulesteix <a href="#ref-probst_hyperparameters_2018">2018</a>)</span>.
<code>mtry</code> indicates how many predictor variables should be used in each tree.
If all predictors are used, then this corresponds in fact to bagging (see beginning of section <a href="eco.html#modeling-the-floristic-gradient">14.4</a>).
The <code>sample.fraction</code> parameter specifies the fraction of observations to be used in each tree.
Smaller fractions lead to greater diversity, and thus less correlated trees which often is desirable (see above).
The <code>min.node.size</code> parameter indicates the number of observations a terminal node should at least have (see also Figure <a href="eco.html#fig:tree">14.4</a>).
Naturally, as trees and computing time become larger, the lower the <code>min.node.size</code>.</p>
<p>Hyperparameter combinations will be selected randomly but should fall inside specific tuning limits (<code>makeParamSet()</code>).
<code>mtry</code> should range between 1 and the number of predictors (4), <code>sample.fraction</code> should range between 0.2 and 0.9 and <code>min.node.size</code> should range between 1 and 10.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" data-line-number="1"><span class="co"># specifying the search space</span></a>
<a class="sourceLine" id="cb456-2" data-line-number="2">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</a>
<a class="sourceLine" id="cb456-3" data-line-number="3">  <span class="kw">makeIntegerParam</span>(<span class="st">&quot;mtry&quot;</span>, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="kw">ncol</span>(rp) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb456-4" data-line-number="4">  <span class="kw">makeNumericParam</span>(<span class="st">&quot;sample.fraction&quot;</span>, <span class="dt">lower =</span> <span class="fl">0.2</span>, <span class="dt">upper =</span> <span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb456-5" data-line-number="5">  <span class="kw">makeIntegerParam</span>(<span class="st">&quot;min.node.size&quot;</span>, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb456-6" data-line-number="6">)</a></code></pre></div>
<p>Finally, <code>tuneParams()</code> runs the hyperparameter tuning, and will find the optimal hyperparameter combination for the specified parameters.
The performance measure is the root mean squared error (RMSE).</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="co"># hyperparamter tuning</span></a>
<a class="sourceLine" id="cb457-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">02082018</span>)</a>
<a class="sourceLine" id="cb457-3" data-line-number="3">tune =<span class="st"> </span><span class="kw">tuneParams</span>(<span class="dt">learner =</span> lrn_rf, </a>
<a class="sourceLine" id="cb457-4" data-line-number="4">                  <span class="dt">task =</span> task,</a>
<a class="sourceLine" id="cb457-5" data-line-number="5">                  <span class="dt">resampling =</span> perf_level,</a>
<a class="sourceLine" id="cb457-6" data-line-number="6">                  <span class="dt">par.set =</span> ps,</a>
<a class="sourceLine" id="cb457-7" data-line-number="7">                  <span class="dt">control =</span> ctrl, </a>
<a class="sourceLine" id="cb457-8" data-line-number="8">                  <span class="dt">measures =</span> mlr<span class="op">::</span>rmse)</a>
<a class="sourceLine" id="cb457-9" data-line-number="9"><span class="co">#&gt;...</span></a>
<a class="sourceLine" id="cb457-10" data-line-number="10"><span class="co">#&gt; [Tune-x] 49: mtry=3; sample.fraction=0.533; min.node.size=5</span></a>
<a class="sourceLine" id="cb457-11" data-line-number="11"><span class="co">#&gt; [Tune-y] 49: rmse.test.rmse=0.5636692; time: 0.0 min</span></a>
<a class="sourceLine" id="cb457-12" data-line-number="12"><span class="co">#&gt; [Tune-x] 50: mtry=1; sample.fraction=0.68; min.node.size=5</span></a>
<a class="sourceLine" id="cb457-13" data-line-number="13"><span class="co">#&gt; [Tune-y] 50: rmse.test.rmse=0.6314249; time: 0.0 min</span></a>
<a class="sourceLine" id="cb457-14" data-line-number="14"><span class="co">#&gt; [Tune] Result: mtry=4; sample.fraction=0.887; min.node.size=10 :</span></a>
<a class="sourceLine" id="cb457-15" data-line-number="15"><span class="co">#&gt; rmse.test.rmse=0.5104918</span></a></code></pre></div>
<p>An <code>mtry</code> of 4, a <code>sample.fraction</code> of 0.887, and a <code>min.node.size</code> of 10 represent the best hyperparameter combination.
A RMSE of 0.51 is relatively good when considering the range of the response variable which is 3.04 (<code>diff(range(rp$sc))</code>).</p>
</div>
<div id="predictive-mapping" class="section level3">
<h3><span class="header-section-number">14.4.2</span> Predictive mapping</h3>
<p>The tuned hyperparameters can now be used for the prediction.
We simply have to modify our learner using the result of the hyperparameter tuning, and run the corresponding model.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" data-line-number="1"><span class="co"># learning using the best hyperparameter combination</span></a>
<a class="sourceLine" id="cb458-2" data-line-number="2">lrn_rf =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="dt">cl =</span> <span class="st">&quot;regr.ranger&quot;</span>,</a>
<a class="sourceLine" id="cb458-3" data-line-number="3">                     <span class="dt">predict.type =</span> <span class="st">&quot;response&quot;</span>,</a>
<a class="sourceLine" id="cb458-4" data-line-number="4">                     <span class="dt">mtry =</span> tune<span class="op">$</span>x<span class="op">$</span>mtry, </a>
<a class="sourceLine" id="cb458-5" data-line-number="5">                     <span class="dt">sample.fraction =</span> tune<span class="op">$</span>x<span class="op">$</span>sample.fraction,</a>
<a class="sourceLine" id="cb458-6" data-line-number="6">                     <span class="dt">min.node.size =</span> tune<span class="op">$</span>x<span class="op">$</span>min.node.size)</a>
<a class="sourceLine" id="cb458-7" data-line-number="7"><span class="co"># doing the same more elegantly using setHyperPars()</span></a>
<a class="sourceLine" id="cb458-8" data-line-number="8"><span class="co"># lrn_rf = setHyperPars(makeLearner(&quot;regr.ranger&quot;, predict.type = &quot;response&quot;),</span></a>
<a class="sourceLine" id="cb458-9" data-line-number="9"><span class="co">#                       par.vals = tune$x)</span></a>
<a class="sourceLine" id="cb458-10" data-line-number="10"><span class="co"># train model</span></a>
<a class="sourceLine" id="cb458-11" data-line-number="11">model_rf =<span class="st"> </span><span class="kw">train</span>(lrn_rf, task)</a>
<a class="sourceLine" id="cb458-12" data-line-number="12"><span class="co"># to retrieve the ranger output, run:</span></a>
<a class="sourceLine" id="cb458-13" data-line-number="13"><span class="co"># mlr::getLearnerModel(model_rf)</span></a>
<a class="sourceLine" id="cb458-14" data-line-number="14"><span class="co"># which corresponds to:</span></a>
<a class="sourceLine" id="cb458-15" data-line-number="15"><span class="co"># ranger(sc ~ ., data = rp, </span></a>
<a class="sourceLine" id="cb458-16" data-line-number="16"><span class="co">#        mtry = tune$x$mtry, </span></a>
<a class="sourceLine" id="cb458-17" data-line-number="17"><span class="co">#        sample.fraction = tune$x$sample.fraction,</span></a>
<a class="sourceLine" id="cb458-18" data-line-number="18"><span class="co">#        min.node.sie = tune$x$min.node.size)</span></a></code></pre></div>
<p>The last step is to apply the model to the spatially available predictors, i.e. to the raster stack.
So far, <code>raster::predict()</code> does not support the output of <strong>ranger</strong> models, hence, we will have to program the prediction ourselves.
First, we convert <code>ep</code> into a prediction dataframe which secondly serves as input for the <code>predict.ranger()</code> function.
Thirdly, we put the predicted values back into a <code>RasterLayer</code> (see section <a href="attr.html#raster-subsetting">3.3.1</a> and Figure <a href="eco.html#fig:rf-pred">14.5</a>).</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1"><span class="co"># convert raster stack into a dataframe</span></a>
<a class="sourceLine" id="cb459-2" data-line-number="2">new_data =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">as.matrix</span>(ep))</a>
<a class="sourceLine" id="cb459-3" data-line-number="3"><span class="co"># apply the model to the dataframe</span></a>
<a class="sourceLine" id="cb459-4" data-line-number="4">pred_rf =<span class="st"> </span><span class="kw">predict</span>(model_rf, <span class="dt">newdata =</span> new_data)</a>
<a class="sourceLine" id="cb459-5" data-line-number="5"><span class="co"># put the predicted values into a raster</span></a>
<a class="sourceLine" id="cb459-6" data-line-number="6">pred =<span class="st"> </span>dem</a>
<a class="sourceLine" id="cb459-7" data-line-number="7"><span class="co"># replace altitudinal values by rf-prediction values</span></a>
<a class="sourceLine" id="cb459-8" data-line-number="8">pred[] =<span class="st"> </span>pred_rf<span class="op">$</span>data<span class="op">$</span>response</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rf-pred"></span>
<img src="figures/rf-pred-1.png" alt="Predictive mapping of the floristic gradient clearly revealing distinct vegetation belts." width="960" />
<p class="caption">
Figure 14.5: Predictive mapping of the floristic gradient clearly revealing distinct vegetation belts.
</p>
</div>
<p>The predictive mapping clearly reveals distinct vegetation belts (Figure <a href="eco.html#fig:rf-pred">14.5</a>).
Please refer to <span class="citation">J. Muenchow, Hauenstein, et al. (<a href="#ref-muenchow_soil_2013">2013</a>)</span> for a detailed descriptions of vegetation belts on <strong>lomas</strong> mountains.
The blue color tones represent the so-called <em>Tillandsia</em>-belt.
<code>Tillandsia</code> is a highly adapted genus especially found in high quantities at the sandy and quite desertic foot of <em>lomas</em> mountains.
The yellow color tones refer to a herbaceous vegetation belt with a much higher plant cover compared to the <em>Tillandsia</em>-belt.
The orange colors represent the bromeliad belt, which features the highest species richness and plant cover.
It can be found directly beneath the temperature inversion (ca. 750-850 m asl) where humidity due to fog is highest.
Water availability naturally decreases above the temperature inversion, and the landscape becomes desertic again with only a few succulent species (succulent belt; red colors).
Interestingly, the spatial prediction clearly reveals that the bromeliad belt is interrupted - a very interesting finding we would have not detected without the predictive mapping.</p>
</div>
</div>
<div id="conclusions-1" class="section level2">
<h2><span class="header-section-number">14.5</span> Conclusions</h2>
<p>In this chapter we have ordinated the community matrix of the <strong>lomas</strong> Mt. Mongón with the help of a NMDS (section <a href="eco.html#nmds">14.3</a>).
The first axis, representing the main floristic gradient in the study area, was modeled as a function of environmental predictors which partly were derived through R-GIS bridges (section <a href="eco.html#data-and-data-preparation">14.2</a>).
The <strong>mlr</strong> package provided the building blocks to spatially tune the hyperparameters <code>mtry</code>, <code>sample.fraction</code> and <code>min.node.size</code> (section <a href="eco.html#mlr-building-blocks">14.4.1</a>).
The tuned hyperparameters served as input for the final model which in turn was applied to the environmental predictors for a spatial representation of the floristic gradient (section <a href="eco.html#predictive-mapping">14.4.2</a>).
The result demonstrates spatially the astounding biodiversity in the middle of the desert.
Since <strong>lomas</strong> mountains are heavily endangered, the prediction map can serve as basis for informed decision-making on delineating protection zones, and making the local population aware of the uniqueness found in their immediate neighborhood.</p>
<p>In terms of methodology, a few additional points could be addressed:</p>
<ul>
<li>It would be interesting to also model the second ordination axis, and to subsequently find an innovative way of visualizing jointly the modeled scores of the two axes in one prediction map.</li>
<li>If we were interested in interpreting the model in an ecologically meaningful way, we should probably use (semi-)parametric models <span class="citation">(J. Muenchow, Bräuning, et al. <a href="#ref-muenchow_predictive_2013">2013</a>; Zuur et al. <a href="#ref-zuur_mixed_2009">2009</a>, <a href="#ref-zuur_beginners_2017">2017</a>)</span>.
However, there are at least approaches that help to interpret machine learning models such as random forests (see e.g., <a href="https://mlr-org.github.io/interpretable-machine-learning-iml-and-mlr/" class="uri">https://mlr-org.github.io/interpretable-machine-learning-iml-and-mlr/</a>).</li>
<li>A sequential model-based optimization (SMBO) might be preferable to the here used random search for hyperparameter optimization <span class="citation">(Probst, Wright, and Boulesteix <a href="#ref-probst_hyperparameters_2018">2018</a>)</span>.</li>
</ul>
</div>
<div id="exercises-10" class="section level2">
<h2><span class="header-section-number">14.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Run a NMDS using the percentage data of the community matrix.
Report the stress value and compare it to the stress value as retrieved from the NMDS using presence-absence data.
What might explain the observed difference?</li>
<li>Compute catchment area and catchment slope using <strong>RSAGA</strong> (see section <a href="gis.html#rsaga">9.3</a>).</li>
<li>Use profile and tangential curvature as additional predictors for the spatial prediction of the floristic gradient (hint: <code>grass7:r.slope.aspect</code>).</li>
<li>Retrieve the bias-reduced RMSE using spatial cross-validation including the estimation of optimal hyperparameter combinations (random search with 50 iterations) in an inner tuning loop (see section <a href="spatial-cv.html#svm">11.5.2</a>).
Parallelize the tuning level (see section <a href="spatial-cv.html#svm">11.5.2</a>).
Report the mean RMSE and use a boxplot to visualize all retrieved RMSEs.</li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dillon_lomas_2003">
<p>Dillon, M. O., M. Nakazawa, and S. G. Leiva. 2003. “The Lomas Formations of Coastal Peru: Composition and Biogeographic History.” In <em>El Niño in Peru: Biology and Culture over 10,000 Years</em>, edited by J. Haas and M. O. Dillon, 1–9. Chicago: Field Museum of Natural History.</p>
</div>
<div id="ref-muenchow_predictive_2013">
<p>Muenchow, Jannes, Achim Bräuning, Eric Frank Rodríguez, and Henrik von Wehrden. 2013. “Predictive Mapping of Species Richness and Plant Species’ Distributions of a Peruvian Fog Oasis Along an Altitudinal Gradient.” <em>Biotropica</em> 45 (5): 557–66. <a href="https://doi.org/10.1111/btp.12049" class="uri">https://doi.org/10.1111/btp.12049</a>.</p>
</div>
<div id="ref-muenchow_soil_2013">
<p>Muenchow, Jannes, Simon Hauenstein, Achim Bräuning, Rupert Bäumler, Eric Frank Rodríguez, and Henrik von Wehrden. 2013. “Soil Texture and Altitude, Respectively, Largely Determine the Floristic Gradient of the Most Diverse Fog Oasis in the Peruvian Desert.” <em>Journal of Tropical Ecology</em> 29 (05): 427–38. <a href="https://doi.org/10.1017/S0266467413000436" class="uri">https://doi.org/10.1017/S0266467413000436</a>.</p>
</div>
<div id="ref-breiman_random_2001">
<p>Breiman, Leo. 2001. “Random Forests.” <em>Machine Learning</em> 45 (1): 5–32. <a href="https://doi.org/10.1023/A:1010933404324" class="uri">https://doi.org/10.1023/A:1010933404324</a>.</p>
</div>
<div id="ref-wickham_tidy_2014">
<p>Wickham, Hadley. 2014b. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10). <a href="https://doi.org/10.18637/jss.v059.i10" class="uri">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
<div id="ref-borcard_numerical_2011">
<p>Borcard, Daniel, François Gillet, and Pierre Legendre. 2011. <em>Numerical Ecology with R</em>. Use R! New York: Springer.</p>
</div>
<div id="ref-vonwehrden_pluralism_2009">
<p>von Wehrden, Henrik, Jan Hanspach, Helge Bruelheide, and Karsten Wesche. 2009. “Pluralism and Diversity: Trends in the Use and Application of Ordination Methods 1990-2007.” <em>Journal of Vegetation Science</em> 20 (4): 695–705. <a href="https://doi.org/10.1111/j.1654-1103.2009.01063.x" class="uri">https://doi.org/10.1111/j.1654-1103.2009.01063.x</a>.</p>
</div>
<div id="ref-mccune_analysis_2002">
<p>McCune, Bruce, James B. Grace, and Dean L. Urban. 2002. <em>Analysis of Ecological Communities</em>. 2nd printing. Gleneden Beach, Or: MjM Software Design.</p>
</div>
<div id="ref-muenchow_rqgis:_2017">
<p>Muenchow, Jannes, Patrick Schratz, and Alexander Brenning. 2017. “RQGIS: Integrating R with QGIS for Statistical Geocomputing.” <em>The R Journal</em> 9 (2): 409–28.</p>
</div>
<div id="ref-schratz_performance_nodate">
<p>Schratz, Patrick, J. Muenchow, Eugenia Iturritxa, Jakob Richter, and A. Brenning. 2018. “Performance Evaluation and Hyperparameter Tuning of Statistical and Machine-Learning Models Using Spatial Data.” <em>Tba</em>.</p>
</div>
<div id="ref-james_introduction_2013">
<p>James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani, eds. 2013. <em>An Introduction to Statistical Learning: With Applications in R</em>. Springer Texts in Statistics 103. New York: Springer.</p>
</div>
<div id="ref-probst_hyperparameters_2018">
<p>Probst, Philipp, Marvin Wright, and Anne-Laure Boulesteix. 2018. “Hyperparameters and Tuning Strategies for Random Forest.” <em>arXiv:1804.03515 [Cs, Stat]</em>, April. <a href="http://arxiv.org/abs/1804.03515" class="uri">http://arxiv.org/abs/1804.03515</a>.</p>
</div>
<div id="ref-zuur_mixed_2009">
<p>Zuur, Alain, Elena N. Ieno, Neil Walker, Anatoly A. Saveliev, and Graham M. Smith. 2009. <em>Mixed Effects Models and Extensions in Ecology with R</em>. Statistics for Biology and Health. New York: Springer-Verlag.</p>
</div>
<div id="ref-zuur_beginners_2017">
<p>Zuur, Alain F., Elena N. Ieno, Anatoly A. Saveliev, and Alain F. Zuur. 2017. <em>Beginner’s Guide to Spatial, Temporal and Spatial-Temporal Ecological Data Analysis with R-INLA</em>. Vol. Volume 1: Using GLM and GLMM. Newburgh, United Kingdom: Highland Statistics Ltd.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="79">
<li id="fn79"><p>In statistics this is also called a contingency or cross-table.<a href="eco.html#fnref79" class="footnote-back">↩</a></p></li>
<li id="fn80"><p>Admittedly, it is a bit unsatisfying, that the only way of knowing that <code>sagawetnessindex</code> computes the desired terrain attributes, is to be familiar with SAGA and/or google for “SAGA catchment slope”.<a href="eco.html#fnref80" class="footnote-back">↩</a></p></li>
<li id="fn81"><p>One way of choosing <code>k</code> is to try <code>k</code> values between 1 and 6 and then using the result which yields the best stress value <span class="citation">(McCune, Grace, and Urban <a href="#ref-mccune_analysis_2002">2002</a>)</span>.<a href="eco.html#fnref81" class="footnote-back">↩</a></p></li>
</ol>
</div>
<script>
/*
Sorts the references alphabetically.
Modified from code by Yvonne Aburrow.
*/
$(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
        return $(b).children('p').html().toUpperCase() > $(a).children('p').html().toUpperCase() ? -1 : 1;
    });
    $('#refs').append(elems);
})
</script>
            </section>

          </div>
        </div>
      </div>
<a href="location.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Robinlovelace/geocompr/edit/master/14-eco.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
